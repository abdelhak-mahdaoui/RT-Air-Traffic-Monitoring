[2023-07-22 06:01:44,118] INFO [BrokerToControllerChannelManager broker=2 name=alterPartition] Node 0 disconnected. (org.apache.kafka.clients.NetworkClient)
[2023-07-22 06:01:46,886] ERROR Error while writing to checkpoint file /tmp/kafka-logs-2/replication-offset-checkpoint (kafka.server.LogDirFailureChannel)
java.io.FileNotFoundException: /tmp/kafka-logs-2/replication-offset-checkpoint.tmp (No such file or directory)
	at java.base/java.io.FileOutputStream.open0(Native Method)
	at java.base/java.io.FileOutputStream.open(FileOutputStream.java:298)
	at java.base/java.io.FileOutputStream.<init>(FileOutputStream.java:237)
	at java.base/java.io.FileOutputStream.<init>(FileOutputStream.java:187)
	at org.apache.kafka.server.common.CheckpointFile.write(CheckpointFile.java:78)
	at kafka.server.checkpoints.CheckpointFileWithFailureHandler.write(CheckpointFileWithFailureHandler.scala:37)
	at kafka.server.checkpoints.OffsetCheckpointFile.write(OffsetCheckpointFile.scala:68)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$7(ReplicaManager.scala:1844)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$7$adapted(ReplicaManager.scala:1844)
	at scala.Option.foreach(Option.scala:437)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$6(ReplicaManager.scala:1844)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$6$adapted(ReplicaManager.scala:1843)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at scala.collection.IterableOps$WithFilter.foreach(Iterable.scala:903)
	at kafka.server.ReplicaManager.checkpointHighWatermarks(ReplicaManager.scala:1843)
	at kafka.server.ReplicaManager.$anonfun$startHighWatermarkCheckPointThread$1(ReplicaManager.scala:282)
	at kafka.utils.KafkaScheduler.$anonfun$schedule$2(KafkaScheduler.scala:116)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2023-07-22 06:01:46,907] ERROR [ReplicaManager broker=2] Error while writing to highwatermark file in directory /tmp/kafka-logs-2 (kafka.server.ReplicaManager)
org.apache.kafka.common.errors.KafkaStorageException: Error while writing to checkpoint file /tmp/kafka-logs-2/replication-offset-checkpoint
Caused by: java.io.FileNotFoundException: /tmp/kafka-logs-2/replication-offset-checkpoint.tmp (No such file or directory)
	at java.base/java.io.FileOutputStream.open0(Native Method)
	at java.base/java.io.FileOutputStream.open(FileOutputStream.java:298)
	at java.base/java.io.FileOutputStream.<init>(FileOutputStream.java:237)
	at java.base/java.io.FileOutputStream.<init>(FileOutputStream.java:187)
	at org.apache.kafka.server.common.CheckpointFile.write(CheckpointFile.java:78)
	at kafka.server.checkpoints.CheckpointFileWithFailureHandler.write(CheckpointFileWithFailureHandler.scala:37)
	at kafka.server.checkpoints.OffsetCheckpointFile.write(OffsetCheckpointFile.scala:68)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$7(ReplicaManager.scala:1844)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$7$adapted(ReplicaManager.scala:1844)
	at scala.Option.foreach(Option.scala:437)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$6(ReplicaManager.scala:1844)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$6$adapted(ReplicaManager.scala:1843)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at scala.collection.IterableOps$WithFilter.foreach(Iterable.scala:903)
	at kafka.server.ReplicaManager.checkpointHighWatermarks(ReplicaManager.scala:1843)
	at kafka.server.ReplicaManager.$anonfun$startHighWatermarkCheckPointThread$1(ReplicaManager.scala:282)
	at kafka.utils.KafkaScheduler.$anonfun$schedule$2(KafkaScheduler.scala:116)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2023-07-22 06:01:46,909] WARN [ReplicaManager broker=2] Stopping serving replicas in dir /tmp/kafka-logs-2 (kafka.server.ReplicaManager)
[2023-07-22 06:01:46,915] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions HashSet(schedules-2, __consumer_offsets-8, flight_info-4, flights-0, __consumer_offsets-35, __consumer_offsets-47, flight_info-3, __consumer_offsets-38, schedules-0, flight_info-1, __consumer_offsets-29, __consumer_offsets-32, schedules-4, __consumer_offsets-41, __consumer_offsets-23, schedules-3, flight_info-0, __consumer_offsets-17, flights-4, flights-3, __consumer_offsets-11, __consumer_offsets-2, __consumer_offsets-14, __consumer_offsets-20, __consumer_offsets-44, flights-2, flight_info-2, schedules-1, flights-1, __consumer_offsets-5, __consumer_offsets-26) (kafka.server.ReplicaFetcherManager)
[2023-07-22 06:01:46,919] INFO [ReplicaAlterLogDirsManager on broker 2] Removed fetcher for partitions HashSet(schedules-2, __consumer_offsets-8, flight_info-4, flights-0, __consumer_offsets-35, __consumer_offsets-47, flight_info-3, __consumer_offsets-38, schedules-0, flight_info-1, __consumer_offsets-29, __consumer_offsets-32, schedules-4, __consumer_offsets-41, __consumer_offsets-23, schedules-3, flight_info-0, __consumer_offsets-17, flights-4, flights-3, __consumer_offsets-11, __consumer_offsets-2, __consumer_offsets-14, __consumer_offsets-20, __consumer_offsets-44, flights-2, flight_info-2, schedules-1, flights-1, __consumer_offsets-5, __consumer_offsets-26) (kafka.server.ReplicaAlterLogDirsManager)
[2023-07-22 06:01:46,945] WARN [ReplicaManager broker=2] Broker 2 stopped fetcher for partitions schedules-2,__consumer_offsets-8,flight_info-4,flights-0,__consumer_offsets-35,__consumer_offsets-47,flight_info-3,__consumer_offsets-38,schedules-0,flight_info-1,__consumer_offsets-29,__consumer_offsets-32,schedules-4,__consumer_offsets-41,__consumer_offsets-23,schedules-3,flight_info-0,__consumer_offsets-17,flights-4,flights-3,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-44,flights-2,flight_info-2,schedules-1,flights-1,__consumer_offsets-5,__consumer_offsets-26 and stopped moving logs for partitions  because they are in the failed log directory /tmp/kafka-logs-2. (kafka.server.ReplicaManager)
[2023-07-22 06:01:46,947] WARN Stopping serving logs in dir /tmp/kafka-logs-2 (kafka.log.LogManager)
[2023-07-22 06:01:46,967] ERROR Shutdown broker because all log dirs in /tmp/kafka-logs-2 have failed (kafka.log.LogManager)
